
1 ì—”í‹°í‹° ë„ì¶œ
ìœ ìŠ¤ì¼€ì´ìŠ¤ì™€ ìš”êµ¬ì‚¬í•­ì—ì„œ ëª…ì‚¬ë¥¼ ì¶”ì¶œí•˜ì—¬ ë‹¤ìŒê³¼ ê°™ì€ í•µì‹¬ ì—”í‹°í‹°ë¥¼ ë„ì¶œí–ˆìŠµë‹ˆë‹¤.

ðŸ‘¤ User (ì‚¬ìš©ìž)

id: UUID (PK)

email: String (ê³ ìœ  ì‹ë³„ìž, Unique)

password: String (í•´ì‹œí™”í•˜ì—¬ ì €ìž¥)

nickname: String (Unique)

profileImageUrl: String

preferredRegion: String (ì„ í˜¸ ì§€ì—­)

provider: Enum (LOCAL, GOOGLE, KAKAO)

role: Enum (USER, ADMIN)

status: Enum (ACTIVE, WITHDRAWN) - íšŒì› íƒˆí‡´ ìƒíƒœ

is2faEnabled: Boolean - 2ë‹¨ê³„ ì¸ì¦ ì—¬ë¶€

createdAt, updatedAt: Timestamp

ðŸ—ºï¸ Place (ìž¥ì†Œ)

id: UUID (PK)

name: String

address: String

category: String

latitude, longitude: Double

â­ Review (ë¦¬ë·°)

id: UUID (PK)

userId: UUID (FK â†’ User)

placeId: UUID (FK â†’ Place)

content: Text

rating: Integer

status: Enum (PENDING, APPROVED, REJECTED) - ì½˜í…ì¸  ìŠ¹ì¸

âœˆï¸ TripPlan (ì—¬í–‰ ê³„íš)

id: UUID (PK)

userId: UUID (FK â†’ User)

title: String

startDate, endDate: Date

ðŸ“ TripPlanItem (ì—¬í–‰ ê³„íš í•­ëª©)

id: UUID (PK)

tripPlanId: UUID (FK â†’ TripPlan)

placeId: UUID (FK â†’ Place)

dayNumber, visitOrder: Integer

ðŸŽ CurationPackage (íë ˆì´ì…˜ íŒ¨í‚¤ì§€)

id: UUID (PK)

createdBy: UUID (FK â†’ User, ê´€ë¦¬ìž)

title: String

description: Text

theme: String

ðŸŽ€ CurationPackageItem (íë ˆì´ì…˜ í•­ëª©)

id: UUID (PK)

packageId: UUID (FK â†’ CurationPackage)

placeId: UUID (FK â†’ Place)

visitOrder: Integer

ðŸ“œ LoginHistory (ë¡œê·¸ì¸ ê¸°ë¡)

id: UUID (PK)

userId: UUID (FK â†’ User)

ipAddress: String

deviceInfo: Text

loginAt: Timestamp

ðŸ“Š UserActivity (ì‚¬ìš©ìž í™œë™ ë¡œê·¸)

id: BIGSERIAL (PK)

userId: UUID (FK â†’ User)

activityType: String (e.g., VIEW_PLACE, CREATE_REVIEW)

targetId: String (í™œë™ ëŒ€ìƒì˜ ID)

abTestGroup: String (A/B í…ŒìŠ¤íŠ¸ ê·¸ë£¹)

createdAt: Timestamp

2 ê´€ê³„ ì„¤ì •
User â†” Review: 1:N (í•œ ëª…ì˜ ì‚¬ìš©ìžëŠ” ì—¬ëŸ¬ ë¦¬ë·°ë¥¼ ìž‘ì„±í•  ìˆ˜ ìžˆìŒ)

Place â†” Review: 1:N (í•˜ë‚˜ì˜ ìž¥ì†Œì—ëŠ” ì—¬ëŸ¬ ë¦¬ë·°ê°€ ë‹¬ë¦´ ìˆ˜ ìžˆìŒ)

User â†” TripPlan: 1:N (í•œ ëª…ì˜ ì‚¬ìš©ìžëŠ” ì—¬ëŸ¬ ì—¬í–‰ ê³„íšì„ ê°€ì§ˆ ìˆ˜ ìžˆìŒ)

TripPlan â†” Place: N:M (TripPlanItem í…Œì´ë¸”ì„ í†µí•´ ê´€ê³„ë¥¼ í•´ê²°)

CurationPackage â†” Place: N:M (CurationPackageItem í…Œì´ë¸”ì„ í†µí•´ ê´€ê³„ë¥¼ í•´ê²°)

User â†” LoginHistory: 1:N (í•œ ëª…ì˜ ì‚¬ìš©ìžëŠ” ì—¬ëŸ¬ ë¡œê·¸ì¸ ê¸°ë¡ì„ ê°€ì§)

User â†” UserActivity: 1:N (í•œ ëª…ì˜ ì‚¬ìš©ìžëŠ” ì—¬ëŸ¬ í™œë™ ë¡œê·¸ë¥¼ ë‚¨ê¹€)

3 ERD ë‹¤ì´ì–´ê·¸ëž¨ (SQL)
SQL

-- ì‚¬ìš©ìž í…Œì´ë¸”
CREATE TABLE users (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    email VARCHAR(255) UNIQUE NOT NULL,
    password VARCHAR(255),
    nickname VARCHAR(100) UNIQUE,
    profile_image_url VARCHAR(500),
    preferred_region VARCHAR(100),
    provider VARCHAR(50) DEFAULT 'LOCAL' NOT NULL,
    role VARCHAR(50) DEFAULT 'USER' NOT NULL,
    status VARCHAR(50) DEFAULT 'ACTIVE' NOT NULL,
    is_2fa_enabled BOOLEAN DEFAULT FALSE NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP,
    updated_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ìž¥ì†Œ í…Œì´ë¸”
CREATE TABLE places (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    name VARCHAR(255) NOT NULL,
    address VARCHAR(500),
    category VARCHAR(100),
    latitude DOUBLE PRECISION,
    longitude DOUBLE PRECISION
);

-- ë¦¬ë·° í…Œì´ë¸”
CREATE TABLE reviews (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    place_id UUID NOT NULL REFERENCES places(id) ON DELETE CASCADE,
    content TEXT,
    rating INTEGER CHECK (rating >= 1 AND rating <= 5),
    status VARCHAR(50) DEFAULT 'PENDING' NOT NULL,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ì—¬í–‰ ê³„íš í…Œì´ë¸”
CREATE TABLE trip_plans (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    title VARCHAR(255) NOT NULL,
    start_date DATE,
    end_date DATE,
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ì—¬í–‰ ê³„íš-ìž¥ì†Œ ì—°ê²° í…Œì´ë¸”
CREATE TABLE trip_plan_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    trip_plan_id UUID NOT NULL REFERENCES trip_plans(id) ON DELETE CASCADE,
    place_id UUID NOT NULL REFERENCES places(id) ON DELETE CASCADE,
    day_number INTEGER,
    visit_order INTEGER
);

-- íë ˆì´ì…˜ íŒ¨í‚¤ì§€ í…Œì´ë¸”
CREATE TABLE curation_packages (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    created_by UUID NOT NULL REFERENCES users(id),
    title VARCHAR(255) NOT NULL,
    description TEXT,
    theme VARCHAR(100),
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- íë ˆì´ì…˜-ìž¥ì†Œ ì—°ê²° í…Œì´ë¸”
CREATE TABLE curation_package_items (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    package_id UUID NOT NULL REFERENCES curation_packages(id) ON DELETE CASCADE,
    place_id UUID NOT NULL REFERENCES places(id) ON DELETE CASCADE,
    visit_order INTEGER
);

-- ë¡œê·¸ì¸ ê¸°ë¡ í…Œì´ë¸”
CREATE TABLE login_history (
    id UUID PRIMARY KEY DEFAULT gen_random_uuid(),
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    ip_address VARCHAR(50),
    device_info TEXT,
    login_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);

-- ì‚¬ìš©ìž í™œë™ ë¡œê·¸ í…Œì´ë¸” (ì¶”ì²œ ì‹œìŠ¤í…œìš©)
CREATE TABLE user_activities (
    id BIGSERIAL PRIMARY KEY,
    user_id UUID NOT NULL REFERENCES users(id) ON DELETE CASCADE,
    activity_type VARCHAR(50) NOT NULL, -- 'VIEW_PLACE', 'CREATE_REVIEW' ë“±
    target_id VARCHAR(255), -- í™œë™ ëŒ€ìƒì˜ ID (place_id, review_id ë“±)
    ab_test_group VARCHAR(50), -- A/B í…ŒìŠ¤íŠ¸ ê·¸ë£¹ ('A', 'B' ë“±)
    created_at TIMESTAMP WITH TIME ZONE DEFAULT CURRENT_TIMESTAMP
);
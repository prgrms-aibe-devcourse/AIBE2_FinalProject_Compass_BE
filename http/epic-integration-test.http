### Epic 통합 테스트 - IntelliJ HTTP Client
### 이 파일을 IntelliJ에서 열면 바로 실행 가능합니다.

### 변수 설정
@baseUrl = http://localhost:8080
@token = YOUR_JWT_TOKEN
@threadId = test-thread-001
@userId = test-user-001

### 1. Epic 1: 입력 폼 요청
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "여행 계획 짜줘",
  "threadId": "{{threadId}}",
  "userId": "{{userId}}"
}

###

### 2. Epic 2: 불완전한 폼 제출 (Follow-up 트리거)
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "form_submit",
  "threadId": "{{threadId}}",
  "userId": "{{userId}}",
  "data": {
    "destinations": ["목적지 미정"],
    "departureLocation": "서울",
    "travelDates": {
      "start": "2024-03-01",
      "end": "2024-03-03"
    }
  }
}

###

### 3. Epic 2: Follow-up 답변
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "제주도랑 부산에 가고 싶어요",
  "threadId": "{{threadId}}",
  "userId": "{{userId}}",
  "context": {
    "phase": "FOLLOW_UP",
    "fieldName": "destinations"
  }
}

###

### 4. Epic 3: 완전한 폼 제출 (계획 생성)
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "form_submit",
  "threadId": "{{threadId}}-complete",
  "userId": "{{userId}}",
  "data": {
    "destinations": ["제주도", "부산"],
    "departureLocation": "서울",
    "travelDates": {
      "start": "2024-03-01",
      "end": "2024-03-05"
    },
    "companions": "가족",
    "budget": 2000000,
    "travelStyle": ["휴양", "관광"]
  }
}

###

### 5. Epic 4: 이미지 업로드 테스트
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "항공권 이미지 업로드했어요",
  "threadId": "{{threadId}}-image",
  "userId": "{{userId}}",
  "attachments": [{
    "type": "image",
    "url": "https://example.com/flight-ticket.jpg"
  }]
}

###

### 6. Epic 5: 일반 대화 테스트
POST {{baseUrl}}/api/chat/unified
Content-Type: application/json
Authorization: Bearer {{token}}

{
  "message": "오늘 서울 날씨 어때?",
  "threadId": "{{threadId}}-general",
  "userId": "{{userId}}"
}

###

### 7. 토큰 없이 테스트 (개발 환경)
POST {{baseUrl}}/api/chat/test
Content-Type: application/json

{
  "message": "여행 계획 짜줘",
  "threadId": "test-no-auth",
  "userId": "anonymous"
}
---
name: ν…μ¤νΈ λ…μ„Έμ„
about: κΈ°λ¥ λ…μ„Έμ„μ— λ€ν• ν…μ¤νΈ μΌ€μ΄μ¤λ¥Ό μ •μν•λ” λ¬Έμ„
title: '[TEST] REQ-CRAWL-001 | Tour API ν΄λΌμ΄μ–ΈνΈ ν…μ¤νΈ'
labels: 'λ°±μ—”λ“'
assignees: 'TRIP1'
---

# π§ ν†µν•© ν…μ¤νΈ μ‘μ„±

## π“‹ ν…μ¤νΈ μ •λ³΄

### ν…μ¤νΈ λ€μƒ
- **ν΄λμ¤λ…**: `TourApiTestController`, `TourApiService`, `TourApiClient`
- **λ©”μ„λ“λ…**: `testConnection()`, `getSeoulTouristSpots()`, `collectAllSeoulData()`
- **νμΌ κ²½λ΅**: `src/test/java/com/compass/domain/trip/controller/TourApiTestControllerTest.java`

### ν…μ¤νΈ λ©μ 
> Tour API ν΄λΌμ΄μ–ΈνΈμ μ „μ²΄ νλ¦„μ΄ μ¬λ°”λ¥΄κ² λ™μ‘ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.
> 
- ν•κµ­κ΄€κ΄‘κ³µμ‚¬ Tour APIμ™€μ μ—°λ™μ΄ μ •μƒμ μΌλ΅ μ΄λ£¨μ–΄μ§€λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
- λ€μ©λ‰ λ°μ΄ν„° μμ§‘ κΈ°λ¥μ΄ 1,000κ° μ΄μƒμ λ°μ΄ν„°λ¥Ό μ„±κ³µμ μΌλ΅ μμ§‘ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.
- κ°μΆ… API μ—”λ“ν¬μΈνΈκ°€ μ¬λ°”λ¥Έ μ‘λ‹µμ„ λ°ν™ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

---

## π― ν…μ¤νΈ μΌ€μ΄μ¤

### μ •μƒ μΌ€μ΄μ¤ (Happy Path)
- [x] **μΌ€μ΄μ¤ 1**: Tour API μ—°κ²° ν…μ¤νΈ
    - **μ…λ ¥**: `GET /api/test/tour/test/connection` μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λκ³ , μ—°κ²° μ„±κ³µ λ©”μ‹μ§€μ™€ μƒν” λ°μ΄ν„° 5κ°κ°€ ν¬ν•¨λ©λ‹λ‹¤.
    - **μ„¤λ…**: Tour APIμ™€μ κΈ°λ³Έμ μΈ μ—°κ²°μ΄ μ •μƒμ μΌλ΅ μ΄λ£¨μ–΄μ§€λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

- [x] **μΌ€μ΄μ¤ 2**: μ„μΈ κ΄€κ΄‘μ§€ λ°μ΄ν„° μ΅°ν
    - **μ…λ ¥**: `GET /api/test/tour/seoul/tourist-spots?pageNo=1&numOfRows=10` μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λκ³ , JSON ν•νƒμ κ΄€κ΄‘μ§€ λ°μ΄ν„°κ°€ λ°ν™λ©λ‹λ‹¤.
    - **μ„¤λ…**: μ§€μ—­ κΈ°λ° κ΄€κ΄‘μ •λ³΄ μ΅°ν APIκ°€ μ •μƒμ μΌλ΅ λ™μ‘ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

- [x] **μΌ€μ΄μ¤ 3**: μΉ΄ν…κ³ λ¦¬λ³„ λ°μ΄ν„° μ΅°ν
    - **μ…λ ¥**: `GET /api/test/tour/seoul/category/Palace?pageNo=1&numOfRows=5` μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λκ³ , Palace μΉ΄ν…κ³ λ¦¬ κ΄€λ ¨ λ°μ΄ν„°κ°€ λ°ν™λ©λ‹λ‹¤.
    - **μ„¤λ…**: μΉ΄ν…κ³ λ¦¬λ³„ ν•„ν„°λ§ κΈ°λ¥μ΄ μ •μƒμ μΌλ΅ λ™μ‘ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

- [x] **μΌ€μ΄μ¤ 4**: λ€μ©λ‰ λ°μ΄ν„° μμ§‘
    - **μ…λ ¥**: `GET /api/test/tour/seoul/all` μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λκ³ , 725KB μ΄μƒμ λ€μ©λ‰ JSON λ°μ΄ν„°κ°€ λ°ν™λ©λ‹λ‹¤.
    - **μ„¤λ…**: 1,000κ° μ΄μƒμ λ°μ΄ν„°λ¥Ό μ„±κ³µμ μΌλ΅ μμ§‘ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

- [x] **μΌ€μ΄μ¤ 5**: λ¨μ λ°μ΄ν„° ν…μ¤νΈ
    - **μ…λ ¥**: `GET /api/test/tour/mock/test` μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λκ³ , ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ μ™„λ£ λ©”μ‹μ§€κ°€ λ°ν™λ©λ‹λ‹¤.
    - **μ„¤λ…**: μ‹¤μ  API νΈμ¶ μ—†μ΄ ν΄λΌμ΄μ–ΈνΈ λ΅μ§μ΄ μ •μƒμ μΌλ΅ λ™μ‘ν•λ”μ§€ κ²€μ¦ν•©λ‹λ‹¤.

### μμ™Έ μΌ€μ΄μ¤ (Exception Cases)
- [x] **API ν‚¤ μ¤λ¥**: μλ»λ API ν‚¤λ΅ μ”μ²­ μ‹λ„
    - **μ…λ ¥**: μλ»λ API ν‚¤λ¥Ό μ‚¬μ©ν• Tour API μ”μ²­
    - **μμƒ κ²°κ³Ό**: HTTP Status `200 OK`κ°€ λ°ν™λμ§€λ§, λΉ λ°μ΄ν„° λλ” μ¤λ¥ λ©”μ‹μ§€κ°€ ν¬ν•¨λ©λ‹λ‹¤.
    - **μ„¤λ…**: API ν‚¤ κ²€μ¦ λ° μ¤λ¥ μ²λ¦¬κ°€ μ¬λ°”λ¥΄κ² λ™μ‘ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

- [x] **λ„¤νΈμ›ν¬ μ¤λ¥**: λ„¤νΈμ›ν¬ μ—°κ²° μ‹¤ν¨ μ‹
    - **μ…λ ¥**: λ„¤νΈμ›ν¬κ°€ μ°¨λ‹¨λ μƒνƒμ—μ„ Tour API μ”μ²­
    - **μμƒ κ²°κ³Ό**: μ μ ν• μ¤λ¥ λ©”μ‹μ§€μ™€ ν•¨κ» λΉ μ‘λ‹µ λλ” μ¤λ¥ μ‘λ‹µμ΄ λ°ν™λ©λ‹λ‹¤.
    - **μ„¤λ…**: λ„¤νΈμ›ν¬ μ¤λ¥ μƒν™©μ— λ€ν• μμ™Έ μ²λ¦¬κ°€ μ¬λ°”λ¥΄κ² λ™μ‘ν•λ”μ§€ ν™•μΈν•©λ‹λ‹¤.

---

## π”§ ν…μ¤νΈ ν™κ²½ μ„¤μ •

### μ„¤μ • νμΌ
- **`src/main/resources/application.yml`**: Tour API μ„¤μ •
- **`src/main/java/com/compass/config/SecurityConfig.java`**: Spring Security μ„¤μ •

### Tour API μ„¤μ •
```yaml
tour:
  api:
    base-url: https://apis.data.go.kr/B551011/KorService2
    service-key: ${TOUR_API_SERVICE_KEY:a1276cb5e93f8b11431d3d2fbfe5e843c3da51d2cd537c50170ea15e87f343ff}
    response-type: json
    num-of-rows: 100
    page-no: 1
    arrange: A
    default-area-code: "1"
```

### Spring Security μ„¤μ •
```java
.requestMatchers("/api/tour/**").permitAll()  // Tour API μ—”λ“ν¬μΈνΈ ν—μ©
```

---

## π“ ν…μ¤νΈ κ²°κ³Ό

### μµμΆ… ν…μ¤νΈ κ²°κ³Ό (2025-09-10 μ‹¤ν–‰)

#### β… μ„±κ³µν• ν…μ¤νΈλ“¤:

1. **Tour API μ—°κ²° ν…μ¤νΈ**
   ```
   μ”μ²­: GET /api/test/tour/test/connection
   μ‘λ‹µ: HTTP 200 OK
   κ²°κ³Ό: β… μ—°κ²° μ„±κ³µ!
   λ°μ΄ν„°: 5κ° (κ°€νλ™μ„±λ‹Ή, κ°„λ°λ©”κ³µμ› λ“±)
   ```

2. **μ„μΈ κ΄€κ΄‘μ§€ λ°μ΄ν„° μ΅°ν**
   ```
   μ”μ²­: GET /api/test/tour/seoul/tourist-spots?pageNo=1&numOfRows=10
   μ‘λ‹µ: HTTP 200 OK
   κ²°κ³Ό: β… JSON λ°μ΄ν„° μ •μƒ μμ§‘
   ν¬κΈ°: 4,975 bytes
   ```

3. **μΉ΄ν…κ³ λ¦¬λ³„ λ°μ΄ν„° μ΅°ν**
   ```
   μ”μ²­: GET /api/test/tour/seoul/category/Palace?pageNo=1&numOfRows=5
   μ‘λ‹µ: HTTP 200 OK
   κ²°κ³Ό: β… Palace μΉ΄ν…κ³ λ¦¬ λ°μ΄ν„° μ •μƒ
   ν¬κΈ°: 2,464 bytes
   ```

4. **λ€μ©λ‰ λ°μ΄ν„° μμ§‘**
   ```
   μ”μ²­: GET /api/test/tour/seoul/all
   μ‘λ‹µ: HTTP 200 OK
   κ²°κ³Ό: β… 1,000κ° μ΄μƒ λ°μ΄ν„° μμ§‘ μ„±κ³µ
   ν¬κΈ°: 725,020 bytes (μ•½ 725KB)
   ```

5. **λ¨μ λ°μ΄ν„° ν…μ¤νΈ**
   ```
   μ”μ²­: GET /api/test/tour/mock/test
   μ‘λ‹µ: HTTP 200 OK
   κ²°κ³Ό: β… ν΄λΌμ΄μ–ΈνΈ κµ¬ν„ μ™„λ£ ν™•μΈ
   ν¬κΈ°: 1,486 bytes
   ```

#### β οΈ μ£Όμμ‚¬ν•­:
- **ν‚¤μ›λ“ κ²€μƒ‰**: λΉ λ°°μ—΄ λ°ν™ (API νΉμ„±μƒ μ •μƒ)
- **Rate Limiting**: API νΈμ¶ κ°„ 100ms λ€κΈ° μ μ©

---

## π§ ν…μ¤νΈ μ‹¤ν–‰ λ°©λ²•

### 1. μ• ν”λ¦¬μΌ€μ΄μ… μ‹μ‘
```bash
./gradlew bootRun
```

### 2. ν…μ¤νΈ μ‹¤ν–‰
```bash
# Tour API μ—°κ²° ν…μ¤νΈ
curl -X GET "http://localhost:8080/api/test/tour/test/connection"

# μ„μΈ κ΄€κ΄‘μ§€ μ΅°ν
curl -X GET "http://localhost:8080/api/test/tour/seoul/tourist-spots?pageNo=1&numOfRows=10"

# μΉ΄ν…κ³ λ¦¬λ³„ μ΅°ν
curl -X GET "http://localhost:8080/api/test/tour/seoul/category/Palace?pageNo=1&numOfRows=5"

# λ€μ©λ‰ λ°μ΄ν„° μμ§‘
curl -X GET "http://localhost:8080/api/test/tour/seoul/all"

# λ¨μ λ°μ΄ν„° ν…μ¤νΈ
curl -X GET "http://localhost:8080/api/test/tour/mock/test"
```

### 3. PowerShell ν…μ¤νΈ
```powershell
# Tour API μ—°κ²° ν…μ¤νΈ
Invoke-WebRequest -Uri "http://localhost:8080/api/test/tour/test/connection" -Headers @{"Content-Type"="application/json"}

# μ„μΈ κ΄€κ΄‘μ§€ μ΅°ν
Invoke-WebRequest -Uri "http://localhost:8080/api/test/tour/seoul/tourist-spots?pageNo=1&numOfRows=10" -Headers @{"Content-Type"="application/json"}

# λ€μ©λ‰ λ°μ΄ν„° μμ§‘
Invoke-WebRequest -Uri "http://localhost:8080/api/test/tour/seoul/all" -Headers @{"Content-Type"="application/json"}
```

---

## π“ μ„±λ¥ ν…μ¤νΈ

### λ°μ΄ν„° μμ§‘ μ„±λ¥
- **κ΄€κ΄‘μ§€**: 500κ° (5νμ΄μ§€ Γ— 100κ°) - μ•½ 2.5μ΄
- **λ¬Έν™”μ‹μ„¤**: 300κ° (3νμ΄μ§€ Γ— 100κ°) - μ•½ 1.5μ΄
- **μμ‹μ **: 300κ° (3νμ΄μ§€ Γ— 100κ°) - μ•½ 1.5μ΄
- **μ‡Όν•‘**: 200κ° (2νμ΄μ§€ Γ— 100κ°) - μ•½ 1.0μ΄
- **λ ν¬μΈ **: 200κ° (2νμ΄μ§€ Γ— 100κ°) - μ•½ 1.0μ΄
- **μ™λ°•**: 100κ° (1νμ΄μ§€ Γ— 100κ°) - μ•½ 0.5μ΄

### μ΄ μμ§‘ μ‹κ°„
- **μ „μ²΄ λ°μ΄ν„° μμ§‘**: μ•½ 8μ΄ (Rate Limiting ν¬ν•¨)
- **λ°μ΄ν„° ν¬κΈ°**: 725KB
- **μμ§‘λ ν•­λ©**: 1,000κ° μ΄μƒ

---

## π” ν…μ¤νΈ κ²€μ¦ ν•­λ©

### API μ—°λ™ κ²€μ¦
- [x] Tour API κΈ°λ³Έ μ—°κ²° μ„±κ³µ
- [x] KorService2 μ—”λ“ν¬μΈνΈ μ •μƒ μ‘λ™
- [x] API ν‚¤ μΈμ¦ μ„±κ³µ
- [x] JSON μ‘λ‹µ νμ‹± μ„±κ³µ

### λ°μ΄ν„° μμ§‘ κ²€μ¦
- [x] μ§€μ—­ κΈ°λ° κ΄€κ΄‘μ •λ³΄ μ΅°ν μ„±κ³µ
- [x] μΉ΄ν…κ³ λ¦¬λ³„ λ°μ΄ν„° ν•„ν„°λ§ μ„±κ³µ
- [x] λ€μ©λ‰ λ°μ΄ν„° μμ§‘ μ„±κ³µ
- [x] μ¤‘λ³µ μ κ±° λ΅μ§ μ •μƒ μ‘λ™

### μ—λ¬ μ²λ¦¬ κ²€μ¦
- [x] API μ¤λ¥ μƒν™© μ²λ¦¬
- [x] λ„¤νΈμ›ν¬ μ¤λ¥ μ²λ¦¬
- [x] λΉ λ°μ΄ν„° μ‘λ‹µ μ²λ¦¬
- [x] Rate Limiting μ μ©

### λ³΄μ• κ²€μ¦
- [x] Spring Security μ„¤μ • μ •μƒ
- [x] `/api/tour/**` κ²½λ΅ ν—μ© ν™•μΈ
- [x] API ν‚¤ μ™Έλ¶€ν™” μ μ©

---

## β… ν…μ¤νΈ μ™„λ£ μ΅°κ±΄

- [x] Tour API μ—°κ²° ν…μ¤νΈ μ„±κ³µ
- [x] μ„μΈ κ΄€κ΄‘μ§€ λ°μ΄ν„° μ΅°ν μ„±κ³µ
- [x] μΉ΄ν…κ³ λ¦¬λ³„ λ°μ΄ν„° μ΅°ν μ„±κ³µ
- [x] λ€μ©λ‰ λ°μ΄ν„° μμ§‘ μ„±κ³µ (1,000κ° μ΄μƒ)
- [x] λ¨μ λ°μ΄ν„° ν…μ¤νΈ μ„±κ³µ
- [x] μ—λ¬ μ²λ¦¬ κ²€μ¦ μ™„λ£
- [x] μ„±λ¥ ν…μ¤νΈ μ™„λ£
- [x] λ³΄μ• μ„¤μ • κ²€μ¦ μ™„λ£

---

## π“ μ°Έκ³ μ‚¬ν•­

### API μ ν•μ‚¬ν•­
- **Rate Limiting**: API νΈμ¶ κ°„ 100ms λ€κΈ° ν•„μ”
- **λ°μ΄ν„° ν¬κΈ°**: λ€μ©λ‰ μμ§‘ μ‹ λ©”λ¨λ¦¬ μ‚¬μ©λ‰ μ£Όμ
- **λ„¤νΈμ›ν¬**: μ•μ •μ μΈ μΈν„°λ„· μ—°κ²° ν•„μ”

### ν…μ¤νΈ ν™κ²½
- **κ°λ° ν™κ²½**: Windows 10, PowerShell
- **μ• ν”λ¦¬μΌ€μ΄μ…**: Spring Boot 3.x
- **λ°μ΄ν„°λ² μ΄μ¤**: H2 (ν…μ¤νΈμ©)
- **API**: ν•κµ­κ΄€κ΄‘κ³µμ‚¬ Tour API KorService2

### λ‹¤μ λ‹¨κ³„
- **REQ-CRAWL-002**: Phase-λ³„ ν¬λ΅¤λ§ κµ¬ν„
- **REQ-CRAWL-003**: tour_places ν…μ΄λΈ” κµ¬ν„
- **λ°μ΄ν„°λ² μ΄μ¤ μ €μ¥**: μμ§‘λ λ°μ΄ν„° RDS μ €μ¥
- **AI μ¶”μ² μ‹μ¤ν…**: μμ§‘λ λ°μ΄ν„° κΈ°λ° AI μ¶”μ²

---

- **π“… μµμΆ… κ²€μ¦**: 2025-09-09 16:21 - Tour API ν΄λΌμ΄μ–ΈνΈ ν…μ¤νΈ μ™„λ£
